let $line-wrap := function($in,$length as xs:integer) {
  partition(
     tokenize($in), 
     fn($partition, $next) {
        sum(($partition, $next) ! string-length()) + count($partition) gt $length
     }
  ) =!> string-join(" ")
}
return 
   (
    normalize-space(.) 
    => tokenize("\.\s*") 
    => filter(matches(?,"\S"))
   ) ! (
    $line-wrap(.,30) 
    => string-join("&#xA;") 
    => concat(".")
   )